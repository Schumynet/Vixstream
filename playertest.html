<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <title>VixStream — Player compatto (finale)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <!-- Hls.js -->
  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
  <style>
    :root{
      --bg:#000; --panel:#0f0f10; --muted:#1b1b1d; --accent:#e50914; --text:#fff;
      --pad:12px; --compact-h:340px; --compact-h-sm:220px;
      --gap:14px;
    }
    html,body{height:100%;margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,Arial,sans-serif;-webkit-font-smoothing:antialiased}
    header{padding:10px 12px;background:var(--panel);display:flex;align-items:center;gap:10px}
    .back-btn{background:transparent;border:0;color:var(--text);font-size:18px;cursor:pointer;padding:6px;border-radius:6px}
    h1{margin:0;font-size:15px;flex:1}
    .search-bar{display:inline-flex;align-items:center;background:var(--muted);border-radius:6px;overflow:hidden}
    .search-bar input{width:170px;padding:6px;border:0;background:transparent;color:var(--text);outline:0;font-size:14px}
    .search-bar button{padding:6px 8px;border:0;background:var(--accent);color:var(--text);cursor:pointer}
    main{padding:10px;max-width:1100px;margin:0 auto}
    #results{display:flex;flex-wrap:wrap;gap:10px;padding:10px}
    .item{width:98px;text-align:center;cursor:pointer}
    .item img{width:100%;border-radius:6px;display:block}
    .item small{display:block;margin-top:6px;color:#a8a8a8;font-size:12px}

    /* modal base */
    .modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.72);z-index:120;align-items:center;justify-content:center;padding:12px;overflow:auto}
    .card{background:var(--panel);width:100%;max-width:960px;border-radius:10px;padding:var(--pad);box-sizing:border-box;box-shadow:0 10px 30px rgba(0,0,0,0.7);display:flex;flex-direction:column;max-height:90vh;overflow:hidden}
    .header-row{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
    .close-btn{background:transparent;border:0;color:var(--text);font-size:16px;cursor:pointer;padding:6px;border-radius:6px}

    .detailInner{display:flex;gap:12px;align-items:flex-start}
    .detailInner img{width:120px;border-radius:6px}
    .detailInfo h2{margin:0;font-size:16px}
    .detailInfo p{color:#ddd;margin-top:6px;line-height:1.3;font-size:13px}

    /* player */
    .player-card{padding:0;display:flex;flex-direction:column;border-radius:8px;overflow:hidden}
    .playerHeader{display:flex;align-items:center;gap:8px;padding:10px;background:rgba(0,0,0,0.6);border-bottom:1px solid #111}
    .playerBack{background:transparent;border:0;color:var(--text);padding:6px;border-radius:6px;cursor:pointer}
    .playerTitle{font-size:14px;flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}

    .video-wrapper{position:relative;width:100%;max-height:var(--compact-h);background:#000}
    @media (max-width:900px){ .video-wrapper{max-height:var(--compact-h-sm)} }
    video{width:100%;height:100%;object-fit:cover;display:block;background:#000}

    /* center controls flat, no background */
    .center-controls{
      position:absolute;
      top:50%;
      left:50%;
      transform:translate(-50%,-50%);
      display:flex;
      gap:var(--gap);
      align-items:center;
      justify-content:center;
      z-index:10;
      transition:opacity .16s ease,transform .16s ease;
      pointer-events:auto;
    }
    .center-controls.hidden{opacity:0;pointer-events:none;transform:translate(-50%,-45%);}
    .nf-btn{
      width:48px;height:48px;
      background:transparent;border:0;padding:0;margin:0;
      display:inline-flex;align-items:center;justify-content:center;
      cursor:pointer;transition:transform .12s ease,opacity .12s ease;
    }
    .nf-btn svg{width:60%;height:60%;fill:#fff;display:block}
    .nf-btn:hover{transform:scale(1.08)}
    .nf-btn:active{transform:scale(0.96)}
    .nf-play{width:64px;height:64px}
    .nf-play svg{width:100%;height:100%}

    .bottom-bar{display:flex;align-items:center;justify-content:space-between;padding:8px;background:rgba(0,0,0,0.76);gap:8px}
    .left{display:flex;align-items:center;gap:10px;flex:1;min-width:0}
    .right{display:flex;align-items:center;gap:8px}
    .progress-track{flex:1;height:6px;background:rgba(255,255,255,0.06);border-radius:6px;overflow:hidden}
    .progress-track input[type=range]{width:100%;appearance:none;height:6px;background:transparent;margin:0}
    .progress-track input[type=range]::-webkit-slider-thumb{appearance:none;width:10px;height:10px;border-radius:50%;background:var(--accent);margin-top:-2px}
    .icon-btn{width:36px;height:36px;border-radius:8px;border:0;background:transparent;color:var(--text);display:flex;align-items:center;justify-content:center;cursor:pointer}
    .mini-menu{position:absolute;bottom:calc(100% + 10px);left:50%;transform:translateX(-50%);min-width:160px;background:rgba(20,20,20,0.98);color:var(--text);border-radius:8px;padding:8px;box-shadow:0 8px 24px rgba(0,0,0,0.6);z-index:70;display:none}
    .mini-menu.visible{display:block}
    .mini-menu .opt{padding:8px 10px;border-radius:6px;cursor:pointer;font-size:14px;color:#fff}
    .mini-menu .opt:hover{background:rgba(255,255,255,0.03)}
    .mini-menu .header{font-size:12px;color:#bbb;padding:0 8px 6px;margin-bottom:6px;border-bottom:1px solid rgba(255,255,255,0.03)}
    .menu-container{position:relative;display:flex;align-items:center;justify-content:center}

    /* carousel */
    .carousel-wrapper{position:relative;overflow:hidden;padding:6px 0}
    .carousel-scroll{display:flex;gap:10px;overflow-x:auto;scroll-behavior:smooth;padding:6px 12px}
    .carousel-scroll::-webkit-scrollbar{display:none}
    .carousel-arrow{position:absolute;top:50%;transform:translateY(-50%);background:rgba(0,0,0,0.6);color:#fff;border:none;font-size:18px;padding:8px;border-radius:50%;cursor:pointer;z-index:10}
    .carousel-arrow.left{left:6px}
    .carousel-arrow.right{right:6px}
    .cardSmall, .epSmall{min-width:120px;flex:0 0 auto;text-align:center;cursor:pointer}
    .cardSmall img, .epSmall img{width:100%;border-radius:6px}
    .cardSmall .label, .epSmall .epTitle{margin-top:6px;font-size:13px;color:#ccc}
    .epSmall .epInfo{font-size:12px;color:#aaa}

    @media (max-width:600px){ .nf-btn{width:44px;height:44px} .nf-play{width:56px;height:56px} .playerHeader{padding:8px} }

    .toast{position:fixed;left:50%;transform:translateX(-50%);bottom:14px;background:rgba(20,20,20,0.95);color:#fff;padding:8px 12px;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,0.6);z-index:200;display:none}
    .toast.show{display:block;animation:toastin .28s ease}
    @keyframes toastin{from{transform:translate(-50%,8px);opacity:0}to{transform:translate(-50%,0);opacity:1}}
    .sr-only{position:absolute!important;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
  </style>
</head>
<body>
  <!--
    NOTE:
    - Questo file è statico e pensato per GitHub Pages.
    - Per fornire playlist HLS/segmenti con CORS, devi avere un proxy HTTPS che esponda:
        /proxy?u=<encoded-url>        -> passthrough del file richiesto con header CORS
        /proxy-m3u8?u=<encoded-url>   -> riscrive gli URL dentro la playlist .m3u8 in modo che i segmenti passino sempre tramite /proxy
      Esempio: https://tuo-proxy.example.com/proxy-m3u8?u=https://origin/playlist.m3u8
    - Se vuoi, ti fornisco il codice Node/Express del proxy.
  -->
  <header>
    <button class="back-btn" id="globalBack">←</button>
    <h1>VixStream</h1>